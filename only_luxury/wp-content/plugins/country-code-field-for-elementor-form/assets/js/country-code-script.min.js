class CCFEF extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{inputTelTextArea:"textarea.ccfef_country_code_data_js",intlInputSpan:".ccfef-editor-intl-input",submitButton:"div.elementor-field-type-submit button"}}}getDefaultElements(){const e=this.getSettings("selectors");return{$textArea:this.$element.find(e.inputTelTextArea),$intlSpanElement:this.$element.find(e.intlInputSpan),$submitButton:this.$element.find(e.submitButton)}}bindEvents(){this.telId=new Array,this.includeCountries={},this.excludeCountries={},this.defaultCountry={},this.iti={},this.getIntlUserData(),this.appendCountryCodeHandler(),this.addCountryCodeInputHandler(),this.customFlags(),this.removeInputTelSpanEle(),this.intlInputValidation()}appendCountryCodeHandler(){this.telId.forEach(e=>{this.addCountryCodeIconHandler(e.formId,e.fieldId,e.customId)})}addCountryCodeIconHandler(e,t,n){const i=CCFEFCustomData.pluginDir+"assets/intl-tel-input/js/utils.min.js",s=jQuery(`.elementor-widget.elementor-widget-form[data-id="${e}"] .elementor-field-type-tel.elementor-field-group input[type="tel"]#${n}`)[0];if(void 0!==s){let n=[],l=[],o="in";const r=["in","us","gb","ru","fr","de","br","cn","jp","it"],a=`${e}${t}`;if(this.includeCountries.hasOwnProperty(a)&&this.includeCountries[a].length>0&&(o=this.includeCountries[a][0],n=this.includeCountries[a].map(e=>e)),this.excludeCountries.hasOwnProperty(a)&&this.excludeCountries[a].length>0){let e=r.filter(e=>!this.excludeCountries[a].includes(e));o=e[0],l=this.excludeCountries[a].map(e=>e)}this.defaultCountry[a]&&""!==this.defaultCountry[a]&&(o=this.defaultCountry[a]);const u=window.intlTelInput(s,{initialCountry:o,utilsScript:i,formatOnDisplay:!1,formatAsYouType:!0,autoFormat:!1,containerClass:"cfefp-intl-container",useFullscreenPopup:!1,onlyCountries:n,excludeCountries:l,customPlaceholder:function(e,t){let n=e;"in"===t.iso2&&(n=e.replace(/^0+/,""));const i=`+${t.dialCode} ${n}`;return i.replace(/\s/g,"")}});s.removeAttribute("pattern"),this.iti[e+t]=u}}addCountryCodeInputHandler(){const e=this.iti;Object.keys(e).forEach(t=>{const n=e[t],i=n.telInput;let s=n.getSelectedCountryData(),l=`+${s.dialCode}`,o=!1;const r=()=>{o=!1},a=e=>{this.customFlags();const t=n.getSelectedCountryData(),i=`+${t.dialCode}`;if("keydown"===e.type||"input"===e.type)o=!0,clearTimeout(r),setTimeout(r,400),s.dialCode!==t.dialCode?s=t:s.dialCode===t.dialCode&&s.iso2!==t.iso2&&n.setCountry(s.iso2);else if("countrychange"===e.type){if(o)return;s=t}this.updateCountryCodeHandler(e.currentTarget,i,l),l=i};i.addEventListener("keydown",a),i.addEventListener("input",a),i.addEventListener("countrychange",a)})}updateCountryCodeHandler(e,t,n){let i=e.value;t&&"+undefined"===t||["","+"].includes(i)||(t!==n&&(i=i.replace(new RegExp(`^\\${n}`),"")),i.startsWith(t)||(i=i.replace(/\+/g,""),e.value=t+i))}customFlags(){const e=this.$element.find(".cfefp-intl-container .iti__country-container .iti__flag:not(.iti__globe)");e.each(function(){const e=this,t=e.className.split(" ");if(t[1]){const n=t[1].split("__")[1],i=CCFEFCustomData.pluginDir+`assets/flags/${n}.svg`;e.style.backgroundImage=`url('${i}')`}})}removeInputTelSpanEle(){this.$element.find("span.ccfef-editor-intl-input").remove()}getIntlUserData(){const e=this.elements.$intlSpanElement,t=[];e.each((e,n)=>{const i=jQuery(n),s=i.data("include-countries"),l=i.data("exclude-countries"),o=i.data("defaultCountry"),r=i.data("id"),a=i.data("field-id"),u=i.closest(".elementor-element.elementor-widget-form").data("id"),d=`${u}${a}`;if(""!==s){const e=s.split(",");this.includeCountries[d]=e}if(""!==l){const e=l.split(",");this.excludeCountries[d]=e}""!==o&&(this.defaultCountry[d]=o),t.includes(d)||(this.telId.push({formId:u,fieldId:a,customId:r}),t.push(d))})}intlInputValidation(){this.elements.$submitButton.on("click",e=>{const t=this.iti;Object.keys(t).length>0&&Object.keys(t).forEach(n=>{const i=t[n],s=i.telInput;""!==s.value&&(s.value=s.value.replace(/[^0-9+]/g,""));const l=s.closest(".elementor-field-group"),o=l.querySelector(".cfefp-intl-container");o&&s.offsetHeight&&o.style.setProperty("--cfefp-intl-tel-button-height",`${s.offsetHeight}px`);const r=jQuery(s).parent();r.find("span.elementor-message").remove();const a=CCFEFCustomData.errorMap;let u='<span class="elementor-message elementor-message-danger elementor-help-inline elementor-form-help-inline" role="alert">';if(""!==s.value)if(i.isValidNumber())jQuery(s).closest(".cfefp-intl-container").removeClass("elementor-error");else{const t=i.getValidationError();void 0!==t&&a[t]&&(u+=a[t]+"</span>",jQuery(s).closest(".cfefp-intl-container").addClass("elementor-error"),jQuery(s).after(u),e.preventDefault())}})})}}jQuery(window).on("elementor/frontend/init",()=>{const e=e=>{elementorFrontend.elementsHandler.addHandler(CCFEF,{$element:e})};elementorFrontend.hooks.addAction("frontend/element_ready/form.default",e)});